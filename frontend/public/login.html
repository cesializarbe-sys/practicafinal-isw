<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Acceso — CRUD Clientes</title>
  <link rel="stylesheet" href="/estilos.css">
  <style>/* small helper to keep the page isolated from other views */
    body { margin:0; }
  </style>
</head>
<body>
  <main class="app-shell">
    <section class="brand-panel" aria-hidden="true">
      <div class="brand-inner">
        <div class="brand-logo">CC</div>
        <h1 class="brand-title">CRUD Clientes</h1>
        <p class="brand-lead">Gestiona tus clientes de forma sencilla y segura.</p>
        <ul class="brand-features">
          <li>Autenticación por sesión</li>
          <li>Crear / Editar / Eliminar clientes</li>
          <li>Interfaz ligera y responsiva</li>
        </ul>
      </div>
    </section>

    <section class="form-panel">
      <div class="form-card">
        <div class="form-top">
          <h2 class="form-title">Inicia sesión</h2>
          <p class="form-sub">Accede a tu cuenta para gestionar clientes</p>
        </div>

        <div id="error" class="error" style="display:none"></div>

        <form id="login-form" method="post" action="/login" novalidate>
          <div class="field">
            <label for="usuario">Usuario</label>
            <input id="usuario" name="usuario" required placeholder="tu.usuario" autocomplete="username" autofocus />
          </div>

          <div class="field">
            <label for="password">Contraseña</label>
            <input id="password" name="password" type="password" required placeholder="••••••••" autocomplete="current-password" />
          </div>

          <div class="actions">
            <button type="submit" class="primary">Entrar</button>
            <button type="button" class="ghost" onclick="document.getElementById('usuario').value='cesia';document.getElementById('password').value='54321'">Demo</button>
          </div>
        </form>

        <p class="hint">¿No tienes cuenta? Usa las credenciales demo abajo.</p>
        <p class="demo-cred"><strong>Usuario:</strong> cesia &nbsp; <strong>Contraseña:</strong> 54321</p>
      </div>
    </section>
  </main>

  <script>
    // intercept form to handle JSON response gracefully
    const form = document.getElementById('login-form');
    const err = document.getElementById('error');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const fd = new FormData(form);
      const body = { usuario: fd.get('usuario'), password: fd.get('password') };
      try {
        const r = await fetch('/login', { method: 'POST', headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }, body: JSON.stringify(body) });
        if (r.status === 200) return window.location = '/clientes.html';
        const data = await r.json();
        err.style.display = 'block'; err.textContent = data.error || 'Error en login';
      } catch (errx) {
        err.style.display = 'block'; err.textContent = 'Error de servidor';
      }
    });
  </script>
</body>
</html>